<div class="affairesDashboard">

    <!-- TITRE -->
    <md-card>
        <md-card-header>
            <div class="md-gutter md-layout">
                <div class="md-layout-item md-size-50">
                    <div class="md-title">
                        Affaire {{ affaire.id }}
                        <span v-if="affaire.nom != '-'">[{{ affaire.nom }}]</span>
                    </div>
                </div>
                <div class="md-layout-item ma-size-50">
                    <div class="md-layout md-alignment-center-right">
                        <md-button class="md-primary md-raised" v-on:click="">Dupliquer</md-button>
                        <md-button class="md-accent md-raised" v-on:click="">Clore</md-button>
                    </div>
                </div>
            </div>
        </md-card-header>
    </md-card>

    <!-- INFORMATIONS GENERALES -->
    <div class="leftColumn">
        <md-card class="mapHeight">
            <md-card-content>
                <div class="md-layout md-gutter ">
                    <div class="md-layout-item md-size-50 md-small-size-100">
                        <md-field>
                            <label>Cadastre</label>
                            <md-input v-model="affaire.cadastre" readonly></md-input>
                        </md-field>
                    </div>

                    <div class="md-layout-item md-size-50 md-small-size-100">
                        <md-field>
                            <label>Type</label>
                            <md-input v-model="affaire.type_affaire" readonly></md-input>
                        </md-field>
                    </div>
                </div>

                <div class="md-layout md-gutter ">
                    <div class="md-layout-item md-size-50 md-small-size-100">
                        <md-field>
                            <label>Opérateur</label>
                            <md-input v-model="affaire.technicien" readonly>
                            </md-input>
                        </md-field>
                    </div>
                    <div class="md-layout-item md-size-50 md-small-size-100">
                        <md-field>
                            <label>Validation</label>
                            <md-input v-model="affaire.responsable" readonly>
                            </md-input>
                        </md-field>
                    </div>
                </div>

                <div class="md-layout md-gutter ">
                    <div class="md-layout-item md-size-50 md-small-size-100">
                        <md-field>
                            <label>Client</label>
                            <md-input v-model="affaire.client" readonly></md-input>
                        </md-field>
                    </div>
                    <div class="md-layout-item md-size-50 md-small-size-100">
                        <md-field>
                            <label>Représenté par</label>
                            <md-input v-model="affaire.client_par" readonly></md-input>
                        </md-field>
                    </div>
                </div>

                <div class="md-layout md-gutter ">
                    <div class="md-layout-item md-size-50 md-small-size-100">
                        <md-field>
                            <label v-if="readonly">Nom de l'affaire</label>
                            <label v-else><strong style="color: blue">Nom de l'affaire</strong></label>
                            <md-input v-model="affaire.nom" :readonly="readonly"></md-input>
                        </md-field>
                    </div>
                    <div class="md-layout-item md-size-50 md-small-size-100">
                        <md-field>
                            <label v-if="readonly">v/ref</label>
                            <label v-else><strong style="color: blue">v/ref</strong></label>
                            <md-input v-model="affaire.vref" :readonly="readonly"></md-input>
                        </md-field>
                    </div>
                </div>

                <div class="md-layout md-gutter">
                    <div class="md-layout-item md-size-25 md-small-size-100">
                        <md-field>
                            <label>Date de la demande</label>
                            <md-input v-model="affaire.date_ouverture"></md-input>
                        </md-field>
                    </div>
                    <div class="md-layout-item md-size-25 md-small-size-100">
                        <!-- Affiche la date de validation en mode readonly -->
                        <md-field v-if="readonly">
                            <label>Date de la validation</label>
                            <md-input v-model="affaire.date_validation" readonly></md-input>
                        </md-field>
                        <!-- Affiche la date de validation en mode édition -->
                        <md-datepicker v-model="affaire.date_validation" v-else>
                            <label><strong style="color: blue">Date de la validation</strong></label>
                        </md-datepicker>
                    </div>
                    <div class="md-layout-item md-size-25 md-small-size-100">
                        <!-- Affiche la date de clôture en mode readonly -->
                        <md-field v-if="readonly">
                            <label>Date de clôture</label>
                            <md-input v-model="affaire.date_cloture" readonly></md-input>
                        </md-field>
                        <!-- Affiche la date de clôture en mode édition -->
                        <md-datepicker v-model="affaire.date_cloture" v-else>
                            <label><strong style="color: blue">Date de la clôture</strong></label>
                        </md-datepicker>
                    </div>
                </div>

                <div class="md-layout md-gutter">
                    <div class="md-layout-item md-size-100 md-small-size-100">
                        <md-field>
                            <label v-if="readonly">Informations</label>
                            <label v-else><strong style="color: blue">Informations</strong></label>
                            <md-textarea v-model="affaire.information" :readonly="readonly" md-autogrow>
                            </md-textarea>
                        </md-field>
                    </div>
                </div>

                <div class="md-layout md-gutter">
                    <div class="md-layout-item">
                        <div class="md-layout md-alignment-bottom-right">
                            <div v-if="readonly">
                                <md-button class="md-elevation-5 md-dense md-primary" @click="readonly=!readonly">Modifier</md-button>
                            </div>
                            <div v-else>
                                <md-button class="md-raised md-dense md-accent" @click="onCancelEdit">Annuler
                                </md-button>
                                <md-button class="md-raised md-dense md-primary" @click="onConfirmEdit">Enregistrer</md-button>
                            </div>
                        </div>
                    </div>
                </div>

            </md-card-content>
        </md-card>
    </div>


    <!-- MAP -->
    <div class="rightColumn">
        <md-card class="mapHeight">
            <md-card-content>
                <!-- Afficher les oordonnées -->
                <div class="md-layout md-gutter">
                    <div class="md-layout-item md-size-50">
                        <md-field>
                            <label>Coordonnées</label>
                            <md-input v-model="[affaire.localisation_e | 0, affaire.localisation_n | 0].join(' / ')" readonly></md-input>
                        </md-field>
                    </div>
                </div>
                <div id="mapContainer">
                    <MapHandler ref="mapHandler" />
                </div>
            </md-card-content>
        </md-card>
    </div>

    <!-- DOCUMENTS -->
    <div class="affairesDashboard">
        <Documents />
    </div>

    <!-- ENVOIS DE DOCUMENTS -->


    <!-- NUMEROS -->
    <div class="affairesDashboard">
        <numerosAffaire />
    </div>

    <!-- SUIVI D'AFFAIRE -->
    <div class="affairesDashboard">
        <suivi />
    </div>

    <!-- PREAVIS -->
    <div class="affairesDashboard">
        <preavis />
    </div>

    <!-- FACTURATION -->
    <div class="affairesDashboard">
        <Facturation />
    </div>

    <!-- REMARQUE -->
    <div class="affairesDashboard">
        <Remarques />
    </div>

    <!-- CONTROLE TECHNIQUE MUTATION -->
    <div class="affairesDashboard">
        <ControleMutation v-if="affaire.type_id==1" />
    </div>

    <!-- CONTROLE TECHNIQUE PPE -->
    <div class="affairesDashboard">
        <ControlePPE v-if="affaire.type_id==3" />
    </div>

    <!-- SUIVI DU MANDAT -->
    <div class="affairesDashboard">
        <SuiviMandat />
    </div>

</div>